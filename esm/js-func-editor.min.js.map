{"version":3,"file":"js-func-editor.min.js","sources":["../code/range_selection.jsy","../node_modules/undoer/undoer.js","../code/dom.jsy","../code/_refresh.jsy","../code/editor.jsy","../code/func-editor.jsy","../code/js-func-editor.jsy"],"sourcesContent":["\nexport function * relative_selection_ctxmgr(el) ::\n  const sel = el.ownerDocument.getSelection()\n  const sel_rng = 1===sel.rangeCount && sel.getRangeAt(0)\n\n  const rel_rng = as_range_relative(el, sel_rng)\n  yield rel_rng\n\n  const rng = from_range_relative(el, rel_rng)\n  if rng ::\n    sel.removeAllRanges()\n    sel.addRange(rng)\n\n\nexport function as_range_relative(el, rng) ::\n  if ! rng || ! rng.intersectsNode(el) :: return\n\n  const r_el = el.ownerDocument.createRange()\n  r_el.selectNode(el)\n\n  if -1 === rng.compareBoundaryPoints(Range.START_TO_START, r_el) ::\n    return\n  if  1 === rng.compareBoundaryPoints(Range.END_TO_END, r_el) ::\n    return\n\n  return @{}\n    start: as_range_relative_offset @ el, rng.startContainer, rng.startOffset\n    end: as_range_relative_offset @ el, rng.endContainer, rng.endOffset\n\n\nexport function from_range_relative(el, rel_rng) ::\n  if ! rel_rng :: return\n  const start = from_range_relative_offset(el, rel_rng.start)\n  const end = from_range_relative_offset(el, rel_rng.end)\n\n  if start && end ::\n    const rng = el.ownerDocument.createRange()\n    rng.setStart(start[0], start[1])\n    rng.setEnd(end[0], end[1])\n    return rng\n\n\nconst _indexOf = [].indexOf\nexport function as_range_relative_offset(el_root, el, offset) ::\n  while el !== el_root ::\n    const tip = el\n    el = el.parentNode\n    for const node of el.childNodes ::\n      if node !== tip ::\n        offset += node.textContent.length\n      else break\n  return offset\n\n\nexport function from_range_relative_offset(el_root, offset) ::\n  if offset > el_root.textContent.length ::\n    return\n\n  let tip = el_root.childNodes[0]\n  while tip ::\n    const n = tip.textContent.length\n    if n < offset ::\n      // consume leading textContent length\n      offset -= n\n      tip = tip.nextSibling\n\n    else if 3 === tip.nodeType ::\n      // TEXT_NODE with more content than our offset\n      return [tip, offset]\n\n    else ::\n      // drill down into first child\n      tip = tip.childNodes[0]\n\n","\nexport class Undoer {\n\n  /**\n   * @template T\n   * @param {function(T)} callback to call when undo/redo occurs\n   * @param {T=} zero the zero state for undoing everything\n   */\n  constructor(callback, zero=null) {\n    this._duringUpdate = false;\n    this._stack = [zero];\n \n    // nb. Previous versions of this used `input` for browsers other than Firefox (as Firefox\n    // _only_ supports execCommand on contentEditable)\n    this._ctrl = document.createElement('div');\n    this._ctrl.setAttribute('aria-hidden', 'true');\n    this._ctrl.style.opacity = 0;\n    this._ctrl.style.position = 'fixed';\n    this._ctrl.style.top = '-1000px';\n    this._ctrl.style.pointerEvents = 'none';\n    this._ctrl.tabIndex = -1;\n\n    this._ctrl.contentEditable = true;\n    this._ctrl.textContent = '0';\n    this._ctrl.style.visibility = 'hidden';  // hide element while not used\n\n    this._ctrl.addEventListener('focus', (ev) => {\n      // Safari needs us to wait, can't blur immediately.\n      window.setTimeout(() => void this._ctrl.blur(), 0);\n    });\n    this._ctrl.addEventListener('input', (ev) => {\n      if (!this._duringUpdate) {\n        callback(this.data);\n      }\n\n      // clear selection, otherwise user copy gesture will copy value\n      // nb. this _probably_ won't work inside Shadow DOM\n      // nb. this is mitigated by the fact that we set visibility: 'hidden'\n      const s = window.getSelection();\n      if (s.containsNode(this._ctrl, true)) {\n        s.removeAllRanges();\n      }\n    });\n  }\n\n  /**\n   * @return {number} the current stack value\n   */\n  get _depth() {\n    return +(this._ctrl.textContent) || 0;\n  }\n\n  /**\n   * @return {T} the current data\n   * @export\n   */\n  get data() {\n    return this._stack[this._depth];\n  }\n\n  /**\n   * Pushes a new undoable event. Adds to the browser's native undo/redo stack.\n   *\n   * @param {T} data the data for this undo event\n   * @param {!Node=} parent to add to, uses document.body by default\n   * @export\n   */\n  push(data, parent) {\n    // nb. We can't remove this later: the only case we could is if the user undoes everything\n    // and then does some _other_ action (which we can't detect).\n    if (!this._ctrl.parentNode) {\n      // nb. we check parentNode as this would remove contentEditable's history\n      (parent || document.body).appendChild(this._ctrl);\n    }\n\n    const nextID = this._depth + 1;\n    this._stack.splice(nextID, this._stack.length - nextID, data);\n\n    const previousFocus = document.activeElement;\n    try {\n      this._duringUpdate = true;\n      this._ctrl.style.visibility = null;\n      this._ctrl.focus();\n      document.execCommand('selectAll');\n      document.execCommand('insertText', false, nextID);\n    } finally {\n      this._duringUpdate = false;\n      this._ctrl.style.visibility = 'hidden';\n    }\n\n    previousFocus && previousFocus.focus();\n  }\n}\n","import {relative_selection_ctxmgr} from './range_selection.jsy'\nimport {_create_async_queue} from './_refresh.jsy'\nimport {Undoer} from 'undoer/undoer.js'\n\n\nexport function code_editor_dom(host, el_code, state0, opt) ::\n  _init_code_dom(el_code, opt)\n  _init_editor_api(host, el_code, state0)\n\n  const events = opt.events || code_editor_events\n  const _on_evt = bind_evt_dispatch @ events, host, opt\n  for const key of events.keys ::\n    el_code.addEventListener @ key, _on_evt\n\n  return @::\n    for const key of events.keys ::\n      el_code.removeEventListener @ key, _on_evt\n\n\n\nexport const code_editor_events = Object.freeze @:\n  keys: Object.freeze @# 'keydown', 'keyup', 'paste', 'input', 'blur'\n  attrs: Object.freeze @# 'key'\n  table: Object.freeze @:\n    ... bind_evt_editor_input()\n\n    'evt:keydown,key:Tab'(evt, host, opt) ::\n      evt.preventDefault()\n      document.execCommand @ 'insertText', false, opt.tabs || '    '\n\n    'evt:paste'(evt, host) ::\n      evt.preventDefault()\n      const text = evt.clipboardData.getData('text/plain')\n      if text ::\n        document.execCommand @ 'insertText', false, text\n        host.dirty()\n\nexport function bind_evt_dispatch(events, ... ex_args) ::\n  const {table, attrs} = events\n  return @\\ evt ::\n    const evec = @[] `evt:${evt.type}`, ... @\n      attrs\n        .map @ k => `${k}:${evt[k]}`\n        .filter @ Boolean\n\n    for let i=evec.length; i>0; i-- ::\n      const fn = table[evec.slice(0,i)]\n      if fn ::\n        return fn(evt, ... ex_args)\n\nexport function bind_evt_editor_input() ::\n  // specialized input event to work in concert with Undoer\n  const wset = new WeakSet()\n  return @{}\n    'evt:blur'(evt, host) ::\n      if wset.has(host) ::\n        // blur caused by our undo command\n        evt.preventDefault()\n      else ::\n        host._emit_code_change()\n\n    async 'evt:input'(evt, host) ::\n      if wset.has(host) ::\n        return\n\n      wset.add(host)\n      await null\n      try ::\n        const src_code = host.src_code\n        for const _ of host.with_selection() ::\n          document.execCommand @ 'undo', false\n          host.raw_src_code = src_code\n          host.dirty()\n      finally ::\n        wset.delete(host)\n\n\n\nexport function _init_editor_api(host, el_code, state_tip) ::\n  let _undoer = new Undoer @ _do_undo, state_tip\n  function _do_undo(prev_state) ::\n    const save = _undoer\n    _undoer = null\n    try :: host._restore_state(prev_state)\n    finally :: _undoer = save\n\n  const q_async = _create_async_queue(host)\n  let evt_detail = null\n\n  Object.assign @ host, @{}\n    *with_selection() ::\n      for const _ of relative_selection_ctxmgr(el_code) ::\n        yield\n\n    dirty() ::\n      q_async @ host._refresh_selection\n      evt_detail = host._event_from_state(state_tip)\n      q_async @ host.refresh_code\n\n    _refresh_selection() ::\n      for const _ of host.with_selection() ::\n        host.src_code = host.src_code + ''\n\n    _emit_code_change() ::\n      _emit_code_event @ host, evt_detail, ''\n\n    _emit_src_code(el, new_state, shape=['lang', 'src_code']) ::\n      if _state_equal(new_state, state_tip, shape) ::\n        return\n\n      state_tip = new_state\n      if null !== _undoer ::\n        _undoer.push @ host._save_state(new_state), el\n\n      evt_detail = host._event_from_state(state_tip)\n      q_async @ host.refresh_code\n      _emit_code_event @ host, evt_detail, ':input'\n\n\n  q_async @ host.dirty\n  q_async @ host._emit_code_change\n  return host\n\n\nfunction _emit_code_event(host, detail, kind) ::\n  if detail ::\n    return host.dispatchEvent @\n      new CustomEvent @ 'src_code'+kind,\n        @{} detail, bubbles: true\n\nfunction _state_equal(a,b, shape) ::\n  for const k of shape ::\n    if a[k] !== b[k] ::\n      return false\n  return true\n\n\nconst _ed_attrs = /* #__PURE__ */ @{}\n  contentEditable: true\n  spellcheck: false\n\nconst _ed_style = /* #__PURE__ */ @{}\n  outline: 'none'\n  overflowWrap: 'break-word'\n  overflowY: 'auto'\n  resize: 'vertical'\n  whiteSpace: 'pre-wrap'\n\nexport function _init_code_dom(el_code, opt) ::\n  const attrs = {... _ed_attrs, ... opt.attrs || {}}\n  for const k in attrs ::\n    el_code.setAttribute(k, attrs[k])\n\n  Object.assign @ el_code.style,\n    {... _ed_style, ... opt.style || {}}\n\n","\nexport function _create_async_queue(self) ::\n  let _x, _q=[]\n  return enqueue\n\n  function enqueue(fn) ::\n    if fn :: _q.push(fn)\n    if undefined === _x && 0 !== _q.length ::\n      _x = requestAnimationFrame(_q_step)\n\n  async function _q_step() ::\n    let q_snap = _q\n    _q = []\n\n    for let fn of q_snap ::\n      await fn.call(self)\n\n    _x = undefined\n    enqueue()\n\n","import {code_editor_dom} from './dom.jsy'\n\nexport class CodeEditor extends HTMLElement ::\n  static with_options(opt={}) ::\n    return class extends this ::\n      _dom_connect(el, state0) ::\n        code_editor_dom @\n          this, el, state0, opt\n\n  static define_with(key, attrs) ::\n    let klass = class extends this {}\n    Object.assign(klass.prototype, attrs)\n    customElements.define @ key, klass\n    return klass\n\n\n  connectedCallback() ::\n    const src_code = this.textContent\n      .replace(/^\\s*\\r?\\n/, '')\n    this.textContent = ''\n    const state0 = @{} src_code, lang: this.lang\n\n    const el = this._el_code = this._init_code_dom()\n    this._dom_connect(el, state0)\n    this.src_code = src_code\n\n\n  _dom_connect(el, state0) ::\n    code_editor_dom @\n      this, el, state0, {}\n\n\n  disconnectedCallback() ::\n    if this._dom_disconnect ::\n      this._dom_disconnect()\n\n  _init_code_dom(className) ::\n    let odoc = this.ownerDocument\n    const el_code = odoc.createElement('code')\n    const el_pre = odoc.createElement('pre')\n    el_pre.appendChild(el_code)\n    this.appendChild(el_pre)\n    if className ::\n      el_pre.className = className\n    return el_code\n\n\n  static get observedAttributes() :: return @[] 'lang', 'mode'\n  attributeChangedCallback() :: this.dirty()\n  dirty() ::\n\n  get lang() :: return this.getAttribute('lang') || this.default_lang || 'js'\n  set lang(lang) :: this.setAttribute('lang', lang)\n\n  get raw_src_code() ::\n    return this._el_code.textContent\n  set raw_src_code(src_code) ::\n    const {_el_code: el, lang} = this\n    this.render_code(lang, src_code, el)\n    this._emit_src_code @ this, {src_code, lang}\n\n  get src_code() ::\n    return this._el_code.textContent\n  set src_code(src_code) ::\n    this.raw_src_code = src_code\n    this.highlight_src(src_code, this._el_code)\n\n  _save_state(state) :: return state\n  _restore_state({lang, src_code}) ::\n    this.lang = lang\n    this.src_code = src_code\n\n  _event_from_state(state) ::\n    return @{} ... state\n\n  render_code(lang, src_code, el_code, highlight) ::\n    el_code.innerText = '' // clear content\n    el_code.textContent = src_code\n\n    if lang ::\n      const cls_lang = `language-${lang}`\n      el_code.classList.add(cls_lang)\n      el_code.parentNode.classList.add(cls_lang)\n\n    if highlight ::\n      this.highlight_src(src_code, el_code)\n    return el_code\n\n  highlight_src(src_code, el_code) ::\n    if globalThis.Prism ::\n      Prism.highlightElement(el_code)\n\nexport default CodeEditor\n","import {CodeEditor} from './editor.jsy'\n\n\nexport class FuncCodeEditorBase extends CodeEditor ::\n  constructor() ::\n    super()\n\n    this.compiler = this.createCompiler()\n    this.dyn_proto = this._bindDynProto @ this, this.compiler\n\n  createCompiler() ::\n    return new DynFuncCompiler(this.transpile)\n\n  _bindDynProto(host, compiler) ::\n    return @{}\n      compiler\n      lazy() ::\n        let ctx = host.as_compile_ctx(host)\n        let dyn = compiler.compile_func(this.src_code, ctx)\n        Object.assign(this, dyn)\n        this.lazy = _=>this\n        return this\n\n      get dyn_fn() :: return this.lazy().fn\n      get dyn_js() :: return this.lazy().js\n\n\n  static get observedAttributes() ::\n    return super.observedAttributes.concat @# 'name', 'func', 'args'\n\n  get name() :: return this.getAttribute('name') || this.default_name || ''\n  set name(value) :: this.setAttribute('name', value)\n\n  get func() :: return this.getAttribute('func') || this.default_func || ''\n  set func(value) :: this.setAttribute('func', value)\n\n  get args() :: return this.getAttribute('args') || this.default_args || ''\n  set args(value) :: this.setAttribute('args', value)\n\n  get mode() :: return this.getAttribute('mode')\n  set mode(value) :: return this.setAttribute('mode', value)\n\n  as_compile_ctx({name, func, args}) ::\n    return @{} name, func, args\n\n\n  get dyn_fn() :: return this.dyn?.dyn_fn\n  get dyn_js() :: return this.dyn?.dyn_js\n\n  _event_from_state(state) ::\n    return this.dyn = @{}\n      __proto__: this.dyn_proto\n      ... state\n\n  refresh_code() ::\n    let mode = this.mode\n    if ! mode ::\n      this._el_dual &&= void this._el_dual.parentNode.remove()\n      return\n\n    this._el_dual ||= this._init_code_dom(mode)\n\n    let dyn = this.dyn.lazy()\n    let src = this.hasAttribute('debug') ? ''+dyn.fn : dyn.js\n\n    if null != dyn.err ::\n      src = `// ${dyn.err}\\n\\n${src}`\n\n    this.render_code @ 'js', src, this._el_dual, true\n\n\nexport default FuncCodeEditorBase\n\n\nexport class DynFuncCompiler ::\n  constructor(fn_transpile=(src=>src)) ::\n    this.transpile = fn_transpile\n\n  compile_func(src_code, ctx) ::\n    let res = {}\n    try ::\n      res.js = this.transpile(src_code)\n    catch err ::\n      res.err = err\n      return res\n\n    try ::\n      let fn_compile = new Function @\n        `return (${this.as_func_src(res.js, ctx)})`\n\n      res.fn = fn_compile()\n    catch err ::\n      res.err = err\n      return res\n\n    return res\n\n  as_func_src(js_src, {func, name, args}) ::\n    if ! func.match(/\\bfunction\\b/) ::\n      const [_,pre,post] = func.match(/^([^\\*]*)(\\*.*)?$/)\n      func = `${pre||''} function ${post||''}`\n\n    return `${func.trim()} ${name||''}(${args||''}){\\n${js_src}\\n}`\n\n","import {FuncCodeEditorBase} from './func-editor.jsy'\n\nconst JSFuncCodeEditor =\n  FuncCodeEditorBase.define_with @\n    'js-func-editor'\n    @{} default_lang: 'js'\n\nexport @{}\n  JSFuncCodeEditor\n  JSFuncCodeEditor as default\n"],"names":["relative_selection_ctxmgr","el","sel","ownerDocument","getSelection","rel_rng","rng","intersectsNode","r_el","createRange","selectNode","compareBoundaryPoints","Range","START_TO_START","END_TO_END","start","as_range_relative_offset","startContainer","startOffset","end","endContainer","endOffset","as_range_relative","rangeCount","getRangeAt","from_range_relative_offset","setStart","setEnd","from_range_relative","removeAllRanges","addRange","el_root","offset","tip","parentNode","node","childNodes","textContent","length","n","nextSibling","nodeType","Undoer","constructor","callback","zero","this","_duringUpdate","_stack","_ctrl","document","createElement","setAttribute","style","opacity","position","top","pointerEvents","tabIndex","contentEditable","visibility","addEventListener","ev","window","setTimeout","blur","data","s","containsNode","_depth","push","parent","body","appendChild","nextID","splice","previousFocus","activeElement","focus","execCommand","code_editor_dom","host","el_code","state0","opt","attrs","_ed_attrs","k","Object","assign","_ed_style","_init_code_dom","state_tip","_undoer","_do_undo","prev_state","save","_restore_state","q_async","self","_x","_q","enqueue","fn","undefined","requestAnimationFrame","_q_step","async","q_snap","call","_create_async_queue","evt_detail","with_selection","_","dirty","_refresh_selection","_event_from_state","refresh_code","src_code","_emit_code_change","_emit_code_event","_emit_src_code","new_state","shape","a","b","_state_equal","_save_state","_init_editor_api","events","code_editor_events","_on_evt","ex_args","table","evt","evec","type","map","filter","Boolean","i","slice","bind_evt_dispatch","key","keys","removeEventListener","freeze","wset","WeakSet","has","preventDefault","add","raw_src_code","delete","bind_evt_editor_input","tabs","text","clipboardData","getData","detail","kind","dispatchEvent","CustomEvent","bubbles","spellcheck","outline","overflowWrap","overflowY","resize","whiteSpace","CodeEditor","HTMLElement","with_options","_dom_connect","define_with","klass","prototype","customElements","define","connectedCallback","replace","lang","_el_code","disconnectedCallback","_dom_disconnect","className","odoc","el_pre","observedAttributes","attributeChangedCallback","getAttribute","default_lang","render_code","highlight_src","state","highlight","innerText","cls_lang","classList","globalThis","Prism","highlightElement","DynFuncCompiler","fn_transpile","src","transpile","compile_func","ctx","res","js","err","fn_compile","Function","as_func_src","js_src","func","name","args","match","pre","post","JSFuncCodeEditor","super","compiler","createCompiler","dyn_proto","_bindDynProto","lazy","as_compile_ctx","dyn","dyn_fn","dyn_js","concat","default_name","value","default_func","default_args","mode","__proto__","_el_dual","remove","hasAttribute"],"mappings":"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","x_google_ignoreList":[1]}